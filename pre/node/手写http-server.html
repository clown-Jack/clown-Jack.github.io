<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>手动实现http-server效果 | 快乐的小丑</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/static/image/logo.jpg">
    <script language="javascript" type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script language="javascript" type="text/javascript" src="/js/MouseClickEffect.js"></script>
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.13f38f88.css" as="style"><link rel="preload" href="/assets/js/app.e32bf087.js" as="script"><link rel="preload" href="/assets/js/3.9f375187.js" as="script"><link rel="preload" href="/assets/js/1.2449ce55.js" as="script"><link rel="preload" href="/assets/js/12.8136af58.js" as="script"><link rel="prefetch" href="/assets/js/10.e6e8b5c8.js"><link rel="prefetch" href="/assets/js/11.3329ba97.js"><link rel="prefetch" href="/assets/js/13.9638c204.js"><link rel="prefetch" href="/assets/js/14.639d7759.js"><link rel="prefetch" href="/assets/js/15.d8b5b30f.js"><link rel="prefetch" href="/assets/js/16.33a12b57.js"><link rel="prefetch" href="/assets/js/17.ae80f00c.js"><link rel="prefetch" href="/assets/js/18.a7f37ba2.js"><link rel="prefetch" href="/assets/js/19.8c3caaba.js"><link rel="prefetch" href="/assets/js/20.1db8020a.js"><link rel="prefetch" href="/assets/js/21.1edf87ff.js"><link rel="prefetch" href="/assets/js/22.4671fc1e.js"><link rel="prefetch" href="/assets/js/23.7f76a2da.js"><link rel="prefetch" href="/assets/js/24.445097df.js"><link rel="prefetch" href="/assets/js/25.2911b283.js"><link rel="prefetch" href="/assets/js/26.b9865e07.js"><link rel="prefetch" href="/assets/js/27.fdde3f1e.js"><link rel="prefetch" href="/assets/js/28.b98c3fd4.js"><link rel="prefetch" href="/assets/js/29.f41ca7dd.js"><link rel="prefetch" href="/assets/js/30.2373d6c2.js"><link rel="prefetch" href="/assets/js/31.cc15243a.js"><link rel="prefetch" href="/assets/js/32.6db621fb.js"><link rel="prefetch" href="/assets/js/33.a1c63309.js"><link rel="prefetch" href="/assets/js/34.14823e3e.js"><link rel="prefetch" href="/assets/js/35.7bce5687.js"><link rel="prefetch" href="/assets/js/36.649d4a12.js"><link rel="prefetch" href="/assets/js/37.21fa3a10.js"><link rel="prefetch" href="/assets/js/38.e43efa50.js"><link rel="prefetch" href="/assets/js/39.6e630bb0.js"><link rel="prefetch" href="/assets/js/4.708f981d.js"><link rel="prefetch" href="/assets/js/40.86339c01.js"><link rel="prefetch" href="/assets/js/41.26c8593b.js"><link rel="prefetch" href="/assets/js/5.c6a7aaa6.js"><link rel="prefetch" href="/assets/js/6.47906c7a.js"><link rel="prefetch" href="/assets/js/7.f855d5d5.js"><link rel="prefetch" href="/assets/js/8.d3caa70c.js"><link rel="prefetch" href="/assets/js/9.3d3706c8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.13f38f88.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-dad8a512><div data-v-dad8a512><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-dad8a512 data-v-dad8a512><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-dad8a512 data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>快乐的小丑</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>小丑</span>
            
          <!---->
          2021
        </a></span></div></div> <div class="hide" data-v-dad8a512><header class="navbar" data-v-dad8a512><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">快乐的小丑</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/前端/" class="nav-link"><i class="iconfont undefined"></i>
  前端
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/clown-Jack/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-dad8a512></div> <aside class="sidebar" data-v-dad8a512><div class="personal-info-wrapper" data-v-ca798c94 data-v-dad8a512><img src="/avator.jpg" alt="author-avatar" class="personal-img" data-v-ca798c94> <h3 class="name" data-v-ca798c94>
    小丑
  </h3> <div class="num" data-v-ca798c94><div data-v-ca798c94><h3 data-v-ca798c94>19</h3> <h6 data-v-ca798c94>文章</h6></div> <div data-v-ca798c94><h3 data-v-ca798c94>10</h3> <h6 data-v-ca798c94>标签</h6></div></div> <hr data-v-ca798c94></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/前端/" class="nav-link"><i class="iconfont undefined"></i>
  前端
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/clown-Jack/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>手动实现http-server效果</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>小丑</span>
            
          <!---->
          2021
        </a></span></div></div> <div data-v-dad8a512><main class="page"><div class="page-title" style="display:none;"><h1>手动实现http-server效果</h1> <div data-v-3b7f5bdf><i class="iconfont reco-account" data-v-3b7f5bdf><span data-v-3b7f5bdf>小丑</span></i> <i class="iconfont reco-date" data-v-3b7f5bdf><span data-v-3b7f5bdf>2020-09-08</span></i> <i class="iconfont reco-eye" data-v-3b7f5bdf><span id="/pre/node/%E6%89%8B%E5%86%99http-server.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-3b7f5bdf><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="iconfont reco-tag tags" data-v-3b7f5bdf><span class="tag-item" data-v-3b7f5bdf>node</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p><code>http-server</code>是一个简单的零配置命令行 http 服务器。它的功能足够强大，可以用于生产使用，但是它的简单性和可破解性足以用于测试、本地开发和学习。今天我们手动实现一个<code>http-server</code>,首先看一下我们需要用到的东西：</p> <h2 id="依赖的安装包"><a href="#依赖的安装包" class="header-anchor">#</a> 依赖的安装包</h2> <ul><li>http</li> <li>url</li> <li>path</li> <li>fs</li> <li>mime</li> <li>chalk</li> <li>ejs</li></ul> <h2 id="url"><a href="#url" class="header-anchor">#</a> <a href="http://nodejs.cn/api/url.html" title="url" target="_blank" rel="noopener noreferrer">url<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <p><code>url</code>是 node 内置模块,我们看一下返回的数据内容和格式。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> urlObj <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>
  <span class="token string">&quot;https://clown:small@www.baidu.com:443/index.html?a=1#abc&quot;</span><span class="token punctuation">,</span>
  <span class="token boolean">true</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>urlObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>Url <span class="token punctuation">{</span>
  protocol<span class="token operator">:</span> <span class="token string">'https:'</span><span class="token punctuation">,</span>
  slashes<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  auth<span class="token operator">:</span> <span class="token string">'clown:small'</span><span class="token punctuation">,</span>
  host<span class="token operator">:</span> <span class="token string">'www.baidu.com:443'</span><span class="token punctuation">,</span>
  port<span class="token operator">:</span> <span class="token string">'443'</span><span class="token punctuation">,</span>
  hostname<span class="token operator">:</span> <span class="token string">'www.baidu.com'</span><span class="token punctuation">,</span>
  hash<span class="token operator">:</span> <span class="token string">'#abc'</span><span class="token punctuation">,</span>
  search<span class="token operator">:</span> <span class="token string">'?a=1'</span><span class="token punctuation">,</span>
  query<span class="token operator">:</span> <span class="token punctuation">[</span>Object<span class="token operator">:</span> <span class="token keyword">null</span> prototype<span class="token punctuation">]</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token string">'1'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  pathname<span class="token operator">:</span> <span class="token string">'/index.html'</span><span class="token punctuation">,</span>
  path<span class="token operator">:</span> <span class="token string">'/index.html?a=1'</span><span class="token punctuation">,</span>
  href<span class="token operator">:</span> <span class="token string">'https://clown:small@www.baidu.com:443/index.html?a=1#abc'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="http"><a href="#http" class="header-anchor">#</a> http</h2> <p><code>http</code>是 node 的内置模块,启动服务返回数据的格式和信息如下:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;request&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;我来了&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>method<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//大写的</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//当前的路径</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>httpVersion<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//版本号</span>
  <span class="token comment">// 请求行</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//头的字段都是小写的</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;server start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>我来了
<span class="token constant">GET</span>
<span class="token operator">/</span>
<span class="token number">1.1</span>
<span class="token punctuation">{</span>
  host<span class="token operator">:</span> <span class="token string">'localhost:4000'</span><span class="token punctuation">,</span>
  connection<span class="token operator">:</span> <span class="token string">'keep-alive'</span><span class="token punctuation">,</span>
  <span class="token string">'cache-control'</span><span class="token operator">:</span> <span class="token string">'max-age=0'</span><span class="token punctuation">,</span>
  <span class="token string">'upgrade-insecure-requests'</span><span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
  <span class="token string">'user-agent'</span><span class="token operator">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36'</span><span class="token punctuation">,</span>
  accept<span class="token operator">:</span> <span class="token string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9'</span><span class="token punctuation">,</span>
  <span class="token string">'sec-fetch-site'</span><span class="token operator">:</span> <span class="token string">'cross-site'</span><span class="token punctuation">,</span>
  <span class="token string">'sec-fetch-mode'</span><span class="token operator">:</span> <span class="token string">'navigate'</span><span class="token punctuation">,</span>
  <span class="token string">'sec-fetch-dest'</span><span class="token operator">:</span> <span class="token string">'document'</span><span class="token punctuation">,</span>
  <span class="token string">'accept-encoding'</span><span class="token operator">:</span> <span class="token string">'gzip, deflate, br'</span><span class="token punctuation">,</span>
  <span class="token string">'accept-language'</span><span class="token operator">:</span> <span class="token string">'zh-CN,zh;q=0.9'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>其中 req 是个可读流,我们可以拿到请求体的数据<code>chunk</code>,因为<code>chunk</code>是个 buffer 类型,所以不能使用&quot;str+=chunk&quot;,容易出现乱码的情况</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;request&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&lt;Buffer 6e 61 6d 65 3d 63 6c 6f 77 6e 26 26 61 67 65 3d 31 38&gt;</span>
    arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;server start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>可以使用<a href="https://www.jianshu.com/p/07c4dddae43a" title="curl" target="_blank" rel="noopener noreferrer">curl<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>命令来模拟请求数据也可以使用<code>postman</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl --data &quot;name=clown&amp;&amp;age=18&quot; http://localhost:4000
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>querystring</code>是 node 内置模块可以解析字符串</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;request&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;end&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//name=clown&amp;&amp;age=18</span>
    <span class="token keyword">let</span> str <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&quot;content-type&quot;</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&quot;application/x-www-form-urlencoded&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      obj <span class="token operator">=</span> querystring<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    res<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span> <span class="token comment">//成功</span>
    res<span class="token punctuation">.</span>sendDate <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{str:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">.</span>name <span class="token operator">+</span> obj<span class="token punctuation">.</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">}</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;server start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>结果:</p> <p><img src="data:image/png;base64,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" alt=""></p> <h2 id="读取目录"><a href="#读取目录" class="header-anchor">#</a> 读取目录</h2> <p>如果是目录的话默认读取 index.html 文件,否则直接读取</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> mime <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mime&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//第三方模块</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;request&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//获取请求的路径到当前目录下查找</span>
  <span class="token keyword">let</span> <span class="token punctuation">{</span> pathname <span class="token punctuation">}</span> <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//console.log(pathname);   // /client</span>
  <span class="token comment">//console.log(path.resolve(__dirname,pathname));    //C:\client</span>
  <span class="token comment">//console.log(path.join(__dirname,pathname));  //C:\Users\DELL\Desktop\http-server-self\client</span>
  <span class="token keyword">let</span> currentPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> pathname<span class="token punctuation">)</span><span class="token punctuation">;</span>
  fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>currentPath<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> statObj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      req<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">404</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&quot;NOT FOUND&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>statObj<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//判断是不是目录</span>
      currentPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>currentPath<span class="token punctuation">,</span> <span class="token string">&quot;index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      fs<span class="token punctuation">.</span><span class="token function">access</span><span class="token punctuation">(</span>currentPath<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//查询文件是否在目录中</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          req<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">404</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&quot;NOT FOUND&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span>
            <span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span>
            mime<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span>currentPath<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;;charset=utf8&quot;</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
          fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span>currentPath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将可读流通过管道推送到可读流中</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">//.js application/x-javascript  .html text/html</span>
      res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span>
        <span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span>
        mime<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span>currentPath<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;;charset=utf8&quot;</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span>currentPath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><h2 id="class-写法"><a href="#class-写法" class="header-anchor">#</a> class 写法</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mz/fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> mime <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mime&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//第三方模块</span>

<span class="token keyword">class</span> <span class="token class-name">Server</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//这里的this指向Server的实例</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> <span class="token punctuation">{</span> pathname <span class="token punctuation">}</span> <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> currentPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> pathname<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> statObj <span class="token operator">=</span> <span class="token keyword">await</span> fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>currentPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>statObj<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        currentPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>currentPath<span class="token punctuation">,</span> <span class="token string">&quot;index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">await</span> fs<span class="token punctuation">.</span><span class="token function">access</span><span class="token punctuation">(</span>currentPath<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//如果路径不存在那么直接报错</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> currentPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> currentPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emitError</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">sendFile</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> currentPath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> mime<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span>currentPath<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;;charset=utf8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span>currentPath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">emitError</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">404</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&quot;NOT FOUND&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleRequest</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Server</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;server start my&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h2 id="手动实现-http-server"><a href="#手动实现-http-server" class="header-anchor">#</a> 手动实现 http-server</h2> <p>如果是目录的话展示给用户目录的格式</p> <p><img src="data:image/jpeg;base64,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" alt=""></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>当前目录内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
      &lt;%arr.forEach(item=&gt;{%&gt;
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>&lt;%=item.href%&gt;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>&lt;%=item.content%&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
      &lt;%})%&gt;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="启动服务"><a href="#启动服务" class="header-anchor">#</a> 启动服务</h3> <p>我们在控制台启动服务,控制台展示的内容和信息</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleRequest</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>port<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>host<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">yellow</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Starting up http-server, serving </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>dir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> Available on</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">greenBright</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>host<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="data:image/jpeg;base64,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" alt=""></p> <h3 id="核心逻辑"><a href="#核心逻辑" class="header-anchor">#</a> 核心逻辑</h3> <p>首先判断是目录还是文件,如果是目录的话列出目录下的所有列表，这个时候需要读取目录的列表通过<code>ejs</code>模板解析返回需要展示的格式;如果是文件的话直接显示文件的信息给用户。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">try</span><span class="token punctuation">{</span>
      <span class="token comment">//判断是目录还是文件</span>
      <span class="token keyword">let</span> <span class="token punctuation">{</span>pathname<span class="token punctuation">}</span> <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> apsPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dir<span class="token punctuation">,</span><span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>pathname<span class="token punctuation">)</span><span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>apsPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> statObj <span class="token operator">=</span> <span class="token keyword">await</span> fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>apsPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">//如果是目录  列出目录列表</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>statObj<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token comment">//先读取当前目录下的所有列表</span>
         <span class="token keyword">let</span> dirs <span class="token operator">=</span> <span class="token keyword">await</span> fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span>apsPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">//我们需要拿到当前的url和目录的每一项拼接</span>
         <span class="token keyword">let</span> str <span class="token operator">=</span> ejs<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>template<span class="token punctuation">,</span><span class="token punctuation">{</span>arr<span class="token operator">:</span>dirs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>href<span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>pathname<span class="token punctuation">,</span>dir<span class="token punctuation">)</span><span class="token punctuation">,</span>content<span class="token operator">:</span>dir<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;text/html;charset=utf8&quot;</span><span class="token punctuation">)</span>
         res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
         <span class="token comment">//如果是文件  直接将内容展示给用户</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>res<span class="token punctuation">,</span>apsPath<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">sendError</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>res<span class="token punctuation">,</span>apsPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="展示文件内容"><a href="#展示文件内容" class="header-anchor">#</a> 展示文件内容</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">sendFile</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> apsPath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> mime<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span>apsPath<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;;charset=utf8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span>apsPath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_404-处理"><a href="#_404-处理" class="header-anchor">#</a> 404 处理</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">sendError</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> apsPath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">404</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&quot;NOT FOUND&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="完整代码"><a href="#完整代码" class="header-anchor">#</a> 完整代码</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> chalk <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;chalk&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//粉笔  画各种颜色</span>
<span class="token keyword">let</span> mime <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mime&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//解析文件类型的</span>
<span class="token keyword">let</span> ejs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;ejs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//用数据和模板  组成一个页面</span>
<span class="token keyword">let</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mz/fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//promise</span>

<span class="token keyword">let</span> template <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>
  path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./template.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token string">&quot;utf-8&quot;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Server</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>host <span class="token operator">=</span> config<span class="token punctuation">.</span>host<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dir <span class="token operator">=</span> config<span class="token punctuation">.</span>dir<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>port <span class="token operator">=</span> config<span class="token punctuation">.</span>port<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>template <span class="token operator">=</span> template<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">async</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">//判断是目录还是文件</span>
      <span class="token keyword">let</span> <span class="token punctuation">{</span> pathname <span class="token punctuation">}</span> <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> apsPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dir<span class="token punctuation">,</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>pathname<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>apsPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> statObj <span class="token operator">=</span> <span class="token keyword">await</span> fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>apsPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//如果是目录  列出目录列表</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>statObj<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//先读取当前目录下的所有列表</span>
        <span class="token keyword">let</span> dirs <span class="token operator">=</span> <span class="token keyword">await</span> fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span>apsPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//我们需要拿到当前的url和目录的每一项拼接</span>
        <span class="token keyword">let</span> str <span class="token operator">=</span> ejs<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>template<span class="token punctuation">,</span> <span class="token punctuation">{</span>
          arr<span class="token operator">:</span> dirs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
            href<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>pathname<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">,</span>
            content<span class="token operator">:</span> dir<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/html;charset=utf8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">//如果是文件  直接将内容展示给用户</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> apsPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">sendError</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> apsPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">sendError</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> apsPath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">404</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&quot;NOT FOUND&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">sendFile</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> apsPath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> mime<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span>apsPath<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;;charset=utf8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span>apsPath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleRequest</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>port<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>host<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
        chalk<span class="token punctuation">.</span><span class="token function">yellow</span><span class="token punctuation">(</span>
          <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Starting up http-server, serving </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>dir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> Available on</span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">greenBright</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>host<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Server<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><h2 id="commander"><a href="#commander" class="header-anchor">#</a> Commander</h2> <p>通常情况下我们看到命令行输入<code>xxx --help</code>会出现提示信息,这个在node中可以使用<a href="%22https://github.com/tj/commander.js/blob/HEAD/Readme_zh-CN.md%22" title="commander">commander</a></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> commander <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;commander&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
commander<span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;-p --port &lt;n&gt;&quot;</span><span class="token punctuation">,</span><span class="token string">'set http-server port'</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;-o --host &lt;n&gt;&quot;</span><span class="token punctuation">,</span><span class="token string">'set http-server host'</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;-d --dir &lt;n&gt;&quot;</span><span class="token punctuation">,</span><span class="token string">'set http-server directory'</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;--help&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Examples:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;$ http-server-self --port&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>commander<span class="token punctuation">.</span>port<span class="token punctuation">)</span>  <span class="token comment">//默认是undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>commander<span class="token punctuation">.</span>host<span class="token punctuation">)</span>  <span class="token comment">//默认是undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>commander<span class="token punctuation">.</span>dir<span class="token punctuation">)</span>   <span class="token comment">//默认是undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>如果在执行命令行的时候将参数传入 <code>node bin/www.js --port 3000</code>结果会输出<code>3000</code>。</p> <h2 id="配置启动文件"><a href="#配置启动文件" class="header-anchor">#</a> 配置启动文件</h2> <p>在配置node包启动文件的时候需要以下两步:</p> <ul><li>配置<code>package.json</code></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>bin:{
  &quot;http-server-self&quot;: &quot;./bin/www.js&quot;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>配置<code>www.js</code>这个名字是随便起的,告诉系统这个文件是以<code>node</code>方式启动和<code>shell</code>脚本有点类似</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>#! /usr/bin/env node
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>完整代码</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>#<span class="token operator">!</span> <span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>env node

<span class="token comment">//默认启动一个http-server服务 port ip地址</span>
<span class="token comment">//定义一个port属性</span>

<span class="token keyword">let</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
    port<span class="token operator">:</span><span class="token number">4000</span><span class="token punctuation">,</span>
    host<span class="token operator">:</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
    dir<span class="token operator">:</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//在那里启动 路径就是哪</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> commander <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;commander&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> json <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../package.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
commander<span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>version<span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;-p --port &lt;n&gt;&quot;</span><span class="token punctuation">,</span><span class="token string">'set http-server-self port'</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;-o --host &lt;n&gt;&quot;</span><span class="token punctuation">,</span><span class="token string">'set http-server-self host'</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;-d --dir &lt;n&gt;&quot;</span><span class="token punctuation">,</span><span class="token string">'set http-server-self directory'</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;--help&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Examples:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;$ http-server-self --port&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>

        <span class="token comment">//  console.log(commander.port);</span>
        <span class="token comment">//  console.log(commander.host);</span>
        <span class="token comment">//  console.log(commander.dir);</span>
config <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>config<span class="token punctuation">,</span><span class="token operator">...</span>commander<span class="token punctuation">}</span>
<span class="token comment">// console.log(config);</span>

<span class="token keyword">let</span> Server <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../server.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Server</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h2 id="发布npm包"><a href="#发布npm包" class="header-anchor">#</a> 发布npm包</h2> <p>1.第一次发布包时需要登陆。
2.首先要查看你的包名字在npm官网是否存在,如果存在发布时会报<code>403 Forbidden</code> 发布。
3.确定使用的镜像是不是原始镜像,如果不是需要切换到原始镜像</p> <ul><li>npm install nrm -g 镜像源工具管理</li> <li>nrm ls 列出所有源列表</li> <li>nrm use npm  切换镜像</li> <li>npm config list  查看配置文件</li></ul> <h2 id="效果"><a href="#效果" class="header-anchor">#</a> 效果</h2></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">最后更新时间: </span> <span class="time">2020/9/10 下午5:05:18</span></div></footer> <!----> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><canvas id="vuepress-canvas-ribbon"></canvas><canvas id="vuepress-canvas-cursor"></canvas><div></div><!----><div class="reco-bgm-panel" data-v-39f9e6e0><audio id="bgm" src="https://cdn.jsdelivr.net/gh/fudalijunyi/cdn/MP3/年轮.mp3" data-v-39f9e6e0></audio> <div class="reco-float-box" style="bottom:10px;z-index:999999;display:none;" data-v-39f9e6e0 data-v-41bcba48 data-v-39f9e6e0><img src="https://cdn.jsdelivr.net/gh/fudalijunyi/picture-bed/img/20200715154924.png" data-v-39f9e6e0></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-39f9e6e0 data-v-41bcba48 data-v-39f9e6e0><div class="reco-bgm-cover" style="background-image:url(https://cdn.jsdelivr.net/gh/fudalijunyi/picture-bed/img/20200715154924.png);" data-v-39f9e6e0><div class="mini-operation" style="display:none;" data-v-39f9e6e0><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-39f9e6e0></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-39f9e6e0></i></div> <div class="falut-message" style="display:none;" data-v-39f9e6e0>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-39f9e6e0 data-v-41bcba48 data-v-39f9e6e0><div class="info-box" data-v-39f9e6e0><i class="reco-bgm reco-bgm-music music" data-v-39f9e6e0></i>年轮</div> <div class="info-box" data-v-39f9e6e0><i class="reco-bgm reco-bgm-artist" data-v-39f9e6e0></i>张碧晨</div> <div class="reco-bgm-progress" data-v-39f9e6e0><div class="progress-bar" data-v-39f9e6e0><div class="bar" data-v-39f9e6e0></div></div></div> <div class="reco-bgm-operation" data-v-39f9e6e0><i class="reco-bgm reco-bgm-last last" data-v-39f9e6e0></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-39f9e6e0></i> <i class="reco-bgm reco-bgm-play play" data-v-39f9e6e0></i> <i class="reco-bgm reco-bgm-next next" data-v-39f9e6e0></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-39f9e6e0></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-39f9e6e0></i> <div class="volume-bar" data-v-39f9e6e0><div class="bar" data-v-39f9e6e0></div></div></div></div> <div class="reco-bgm-left-box" data-v-39f9e6e0 data-v-41bcba48 data-v-39f9e6e0><i class="reco-bgm reco-bgm-left" data-v-39f9e6e0></i></div></div></div><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="z-index:999999;right:68px;bottom:190px;display:none;" data-v-5775ee02>
      我是lookroot欢迎你的关注 
    </div> <div class="operation" style="right:90px;bottom:40px;display:;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:none;" data-v-5775ee02></i></div> <canvas id="banniang" width="240" height="352" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div></div></div>
    <script src="/assets/js/app.e32bf087.js" defer></script><script src="/assets/js/3.9f375187.js" defer></script><script src="/assets/js/1.2449ce55.js" defer></script><script src="/assets/js/12.8136af58.js" defer></script>
  </body>
</html>
